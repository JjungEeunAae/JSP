<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Info/mamberList.html</title>
  </head>
  <body>
    <h3>fetch API를 활용해보자</h3>
    <table>
      <thead>
        <tr>
          <th>아이디</th>
          <th>이름</th>
          <th>이메일</th>
          <th>성별</th>
          <th>급여</th>
          <th>삭제</th>
        </tr>
      </thead>
      <tbody id="list"></tbody>
    </table>

    <script>
      //배열관련메소드 : forEach , map , filter , reduce 메소드
      //forEach: 배열에 있는 값의 개수만큼만 반환, 리턴 값이 void임
      //map : Key, value를 이용하여 새로운 배열의 값으로 만들어주고 반환해준다
      //filter : 참인 값만 반환하는 것
      //reduce : 조합해서 값을 만드는 방법
      fetch("../data/data.json")
        .then((resolve) => resolve.json())
        .then((result) => {
          //console.log(result);
          result.forEach(function (item, idx, arry) {
            //console.log(item, idx, arry);
            //DOM 요소 생성.

            let titles = ["id", "first_name", "eamil", "gender", "salary"];

            //데이터 건수만큼 반복하기 위한 반복문
            let tr = document.createElement("tr");

            //columns 개수만큼 반복해주는 곳
            titles.forEach((title) => {
              let td = document.createElement("td");
              td.innerText = item[title];
              tr.append(td);
            });

            //삭제버튼
            let td = document.createElement("td");
            let btn = document.createElement("button");
            btn.innerText = "삭제";
            btn.addEventListener("click", function () {
              console.log(this);
              this.parentElement.parentElement.remove();
            });
            td.append(btn);
            tr.append(td);
            list.append(tr);
          }); //forEach : result 배열에 등록되어있는 값의 개수만큼 function()을 실행
        })
        .catch((reject) => {
          console.log(reject);
        });

      // this => 펑션 안에서 사용되지면 해당 디스는 윈도우라는 전역객체를 가르친다
      // () => { this => window전역객체}
      // this => 이벤트안에서 콜백함수에서 쓰여지면 해당 디스는 이벤트를 받는 대상(실행대상)
      // event callback()=>{this => event 대상}
    </script>
  </body>
</html>
